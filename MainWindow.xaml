<Window x:Class="MixItControllerApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MixItControllerApp"
        mc:Ignorable="d"
        Title="MIX IT Controller" Height="600" Width="1000"
        Background="#FF2D2D30">
    <Window.Resources>
        <Style x:Key="VerticalSlider" TargetType="Slider">
            <Setter Property="Orientation" Value="Vertical"/>
        </Style>
        <Style x:Key="VerticalProgressBar" TargetType="ProgressBar">
            <Setter Property="Orientation" Value="Vertical"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Mixer IP:" VerticalAlignment="Center" Foreground="White"/>
            <TextBox Text="{Binding MixerIpAddress}" Width="120" Margin="5,0" VerticalAlignment="Center"/>
            <Button Content="{Binding ConnectionStatus}" Command="{Binding ConnectCommand}" Width="120"/>
            <Ellipse Width="15" Height="15" Fill="{Binding DataReceivedIndicatorBrush}" Margin="10,0,0,0" VerticalAlignment="Center"
                     ToolTip="Data RX Indicator (Flashes green on data reception)"/>
            <TextBlock Text="Preset:" VerticalAlignment="Center" Foreground="White" Margin="20,0,5,0"/>
            <ComboBox ItemsSource="{Binding Presets}" DisplayMemberPath="Name" SelectedItem="{Binding SelectedPreset}" Width="120" VerticalAlignment="Center"/>
            <Button Content="Call Preset" Command="{Binding CallPresetCommand}" Margin="5,0"/>
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="120"/>
            </Grid.ColumnDefinitions>
            
            <ItemsControl Grid.Column="0" ItemsSource="{Binding DisplayChannels}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="8"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="5">
                            <ProgressBar Style="{StaticResource VerticalProgressBar}" Minimum="0" Maximum="100" Value="{Binding MeterLevel}" Background="#FF4B4B4B" Foreground="LimeGreen" BorderThickness="0"/>
                            <Slider Style="{StaticResource VerticalSlider}" Minimum="0" Maximum="255" Value="{Binding GainByte, Mode=TwoWay}" LargeChange="10" TickFrequency="1" IsSnapToTickEnabled="True"
                                    PreviewMouseLeftButtonDown="Slider_PreviewMouseLeftButtonDown"
                                    PreviewMouseLeftButtonUp="Slider_PreviewMouseLeftButtonUp"/>
                            <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                <TextBlock Text="{Binding GainDbText}" Foreground="White" HorizontalAlignment="Center" Margin="0,5"/>
                                <ToggleButton IsChecked="{Binding IsMuted, Mode=OneWay}" Content="MUTE" Command="{Binding DataContext.MuteCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}" CommandParameter="{Binding}" FontWeight="Bold">
                                    <ToggleButton.Style>
                                        <Style TargetType="ToggleButton">
                                            <Setter Property="Background" Value="Gray"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsChecked" Value="True">
                                                    <Setter Property="Background" Value="Red"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ToggleButton.Style>
                                </ToggleButton>
                                <TextBlock Text="{Binding DisplayName}" Foreground="Cyan" HorizontalAlignment="Center" Margin="0,5"/>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            
            <Rectangle Grid.Column="1" Width="1" Fill="Gray" Margin="10,0"/>

            <Grid Grid.Column="2" DataContext="{Binding LrChannel}">
                <ProgressBar Style="{StaticResource VerticalProgressBar}" Minimum="0" Maximum="100" Value="{Binding MeterLevel}" Background="#FF4B4B4B" Foreground="LimeGreen" BorderThickness="0"/>
                <Slider Style="{StaticResource VerticalSlider}" Minimum="0" Maximum="255" Value="{Binding GainByte, Mode=TwoWay}" LargeChange="10" TickFrequency="1" IsSnapToTickEnabled="True"
                        PreviewMouseLeftButtonDown="Slider_PreviewMouseLeftButtonDown"
                        PreviewMouseLeftButtonUp="Slider_PreviewMouseLeftButtonUp"/>
                <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding GainDbText}" Foreground="White" HorizontalAlignment="Center" Margin="0,5"/>
                    <ToggleButton IsChecked="{Binding IsMuted, Mode=OneWay}" Content="MUTE" Command="{Binding DataContext.MuteCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" FontWeight="Bold">
                        <ToggleButton.Style>
                            <Style TargetType="ToggleButton">
                                <Setter Property="Background" Value="Gray"/>
                                <Style.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter Property="Background" Value="Red"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>
                    </ToggleButton>
                    <TextBlock Text="{Binding DisplayName}" Foreground="Yellow" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,5"/>
                </StackPanel>
            </Grid>
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
            <Button Content="IN 1-8" Command="{Binding ChangeLayerCommand}" CommandParameter="IN1-8" Margin="5"/>
            <Button Content="IN 9-16" Command="{Binding ChangeLayerCommand}" CommandParameter="IN9-16" Margin="5"/>
            <Button Content="IN 17-24 / DCA" Command="{Binding ChangeLayerCommand}" CommandParameter="IN17-24" Margin="5"/>
            <Button Content="OUTPUT" Command="{Binding ChangeLayerCommand}" CommandParameter="OUTPUT" Margin="5"/>
        </StackPanel>
    </Grid>
</Window>